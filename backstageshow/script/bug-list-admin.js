
var demodata=[
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:1,
        module:['购买界面','购买下一步','产品信息区域'],
        times:1,
        level:0,
        sub_time:"2017/08/04 22:12:22",
        id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"安度因"
        },
        status:0,
        reply:{

        },
        img:["https://gss1.bdstatic.com/-vo3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D220/sign=94ef21bc9c82d158bf825eb3b00b19d5/0ff41bd5ad6eddc4143c13a939dbb6fd5366338c.jpg",             "https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:0,
        module:['购买界面','购买下一步','产品信息区域'],
        times:1,
        level:1,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:0,
        reply:{

        },
        img:["https://gss1.bdstatic.com/-vo3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D220/sign=94ef21bc9c82d158bf825eb3b00b19d5/0ff41bd5ad6eddc4143c13a939dbb6fd5366338c.jpg",             "https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:1,
        module:['购买界面','购买下一步','产品信息区域'],
        times:1,
        level:2,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:0,
        reply:{
            name:"欢哥",
            content:"？"
        },
        img:["https://gss1.bdstatic.com/-vo3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D220/sign=94ef21bc9c82d158bf825eb3b00b19d5/0ff41bd5ad6eddc4143c13a939dbb6fd5366338c.jpg",             "https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:2,
        module:['购买界面','购买下一步','产品信息区域'],
        times:1,
        level:1,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:0,
        reply:{

        },
        img:["https://gss1.bdstatic.com/-vo3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D220/sign=94ef21bc9c82d158bf825eb3b00b19d5/0ff41bd5ad6eddc4143c13a939dbb6fd5366338c.jpg",             "https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:2,
        module:['购买界面','购买下一步','产品信息区域'],
        times:3,
        level:1,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:0,
        reply:{

        },
        img:["https://gss1.bdstatic.com/-vo3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D220/sign=94ef21bc9c82d158bf825eb3b00b19d5/0ff41bd5ad6eddc4143c13a939dbb6fd5366338c.jpg",             "https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:1,
        module:['购买界面','购买下一步'],
        times:0,
        level:0,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:0,
        reply:{
            name:"欢哥",
            content:"呵呵"
        },
        img:["https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:2,
        module:['购买界面','购买下一步','产品信息区域'],
        times:1,
        level:1,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:1,
        reply:{

        },
        img:["https://gss1.bdstatic.com/-vo3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D220/sign=94ef21bc9c82d158bf825eb3b00b19d5/0ff41bd5ad6eddc4143c13a939dbb6fd5366338c.jpg",             "https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:2,
        module:['购买界面','购买下一步','产品信息区域'],
        times:3,
        level:1,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:1,
        reply:{

        },
        img:["https://gss1.bdstatic.com/-vo3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D220/sign=94ef21bc9c82d158bf825eb3b00b19d5/0ff41bd5ad6eddc4143c13a939dbb6fd5366338c.jpg",             "https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:1,
        module:['购买界面','购买下一步'],
        times:0,
        level:0,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:1,
        reply:{
            name:"欢哥",
            content:"呵呵"
        },
        img:["https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:1,
        module:['购买界面','购买下一步'],
        times:0,
        level:0,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:1,
        reply:{
            name:"欢哥",
            content:"呵呵"
        },
        img:["https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:1,
        module:['购买界面','购买下一步'],
        times:0,
        level:0,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:1,
        reply:{
            name:"欢哥",
            content:"呵呵"
        },
        img:["https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:1,
        module:['购买界面','购买下一步'],
        times:0,
        level:0,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:1,
        reply:{
            name:"欢哥",
            content:"呵呵"
        },
        img:["https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:1,
        module:['购买界面','购买下一步'],
        times:0,
        level:0,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:1,
        reply:{
            name:"欢哥",
            content:"呵呵"
        },
        img:["https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:1,
        module:['购买界面','购买下一步'],
        times:0,
        level:0,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:1,
        reply:{
            name:"欢哥",
            content:"呵呵"
        },
        img:["https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:1,
        module:['购买界面','购买下一步'],
        times:0,
        level:0,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:1,
        reply:{
            name:"欢哥",
            content:"呵呵"
        },
        img:["https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:1,
        module:['购买界面','购买下一步'],
        times:0,
        level:0,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:1,
        reply:{
            name:"欢哥",
            content:"呵呵"
        },
        img:["https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:1,
        module:['购买界面','购买下一步'],
        times:0,
        level:0,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:1,
        reply:{
            name:"欢哥",
            content:"呵呵"
        },
        img:["https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:1,
        module:['购买界面','购买下一步'],
        times:0,
        level:0,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:1,
        reply:{
            name:"欢哥",
            content:"呵呵"
        },
        img:["https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:1,
        module:['购买界面','购买下一步'],
        times:0,
        level:0,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:1,
        reply:{
            name:"欢哥",
            content:"呵呵"
        },
        img:["https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    },
    {
        description:"融合了哪些其他语言的优秀特性？将它和 C#相比各有什么优劣？它会未来的件开发产生什么影响？作为一个程序员，此刻，一",
        from:1,
        module:['购买界面','购买下一步'],
        times:0,
        level:0,
        sub_time:"2017/08/04 22:12:22",id:2,
        solve_time:"2017/09/05 22:12:23",
        user:{
            type:"客服",
            name:"小白"
        },
        status:0,
        reply:{
            name:"欢哥",
            content:"呵呵"
        },
        img:["https://gss2.bdstatic.com/9fo3dSag_xI4khGkpoWK1HF6hhy/baike/whfpf%3D268%2C152%2C50/sign=2b14f3a7898ba61edfbb9b6f2709a53c/5243fbf2b21193132a5f0add6e380cd791238dbb.jpg"]
    }
];

var main =  new Vue({
    el:"#main",
    data:{
        from_limit:[0,1,2], //来源限制
        status_limit:0,             //状态限制
        lis:[],                     //需要展现的订单
        lis_all:[],                 //现有来源限制下的所有订单
        lis_status_all:[],          //现有来源、状态限制下的所有订单
        nowpage:1,                  //现在显示的第几页
        showpages:100,              //一页显示多少条
        nownum:0,                    //现有来源、状态限制下的所有订单个数
        alldata:demodata,
        allnum:10
    },
    computed:{
        Pages:function(){
            return Math.ceil(this.nownum/this.showpages);
        },
        MiddlePages:function(){
            if(this.Pages<6){
                return 0;
            }else{
                if(this.nowpage>3){
                    if(this.Pages-this.nowpage<2){
                        return this.Pages - 5;
                    }else{
                        return this.nowpage-3;
                    }
                }else{
                    return 0;
                }
            }
        },
        NoSolve:function(){
            for(var i=0,j=0;i<this.lis_all.length;i++){
                if(this.lis_all[i].status == 0){
                    j++;
                }
            }
            return j;
        },
        Solve:function(){
            for(var i=0,j=0;i<this.lis_all.length;i++){
                if(this.lis_all[i].status == 1){
                    j++;
                }
            }
            return j;
        }

    },
    methods:{
        GetData:function(){
            var keyword = $("#search-content").val();
            var starttime = $("#search-starttime").html();
            var endtime = $("#search-endtime").html();
            var keyuserid = $("#search-status").attr("data-id");
            var that = this;
            if(endtime>=starttime && endtime){
                $.ajax({             //=====================================================ajax====
                    url:'',
                    type:"POST",
                    data:{
                        userid:"",          //用户ID
                        token:"",           //token
                        from:this.from_limit,   //来源限制
                        keyword:keyword,       //关键词
                        starttime:starttime,   //开始时间
                        endtime:endtime,       //结束时间
                        keyuserid:keyuserid,    //关键人id
                        status:this.status_limit,  //状态限制
                        nowpage:this.nowpage,      //当前页面
                        showpages:this.showpages  //一页显示多少条数据
                    },
                    dataType:'json',
                    success:function(data){
                        that.lis = data.list;
                        that.nownum = data.nownum;
                    }
                });
            }else{
                alert("结束时间必须大于等于开始时间!")
            }


            this.lis=[];
            this.lis_all=[];
            this.lis_status_all=[];
            var m = 0;
            for(let i =0,j=0,k=0;i<this.alldata.length;i++){
                for(var n =0;n<this.from_limit.length;n++){
                    if(this.alldata[i].from == this.from_limit[n]){
                        Vue.set(this.lis_all, j, this.alldata[i]);
                        j++;
                        if(this.status_limit == 100){
                            m++;
                            Vue.set(this.lis_status_all, k, this.alldata[i]);
                            k++;
                        }else if(this.alldata[i].status == this.status_limit){
                            m++;
                            Vue.set(this.lis_status_all, k, this.alldata[i]);
                            k++;
                        }
                    }
                }
            }
            this.nownum = m;
            for(let i = (this.nowpage-1)*this.showpages,j=0;i<this.nowpage*this.showpages && i<this.lis_status_all.length;i++){
                for(var n =0;n<this.from_limit.length;n++){
                    if(this.lis_status_all[i].from == this.from_limit[n]){
                        if(this.status_limit == 100){
                            Vue.set(this.lis, j, this.lis_status_all[i]);
                            j++;
                        }else if(this.lis_status_all[i].status == this.status_limit){
                            Vue.set(this.lis, j, this.lis_status_all[i]);
                            j++;
                        }
                    }
                }
            }

            if(this.nowpage>this.Pages){
                this.nowpage=1;
            }
            if($("#search-content").val()){
                this.$nextTick(function(){
                    toRed($("#search-content").val());
                });
            }

        },
        PageMenu:function(){
            $("#paging .menu").addClass("active");
            $("#paging .menu [data-page="+this.showpages+"]").addClass("active");
        },
        ChangeShowPages:function(){
            event.stopPropagation();
            if(!$(event.target).hasClass("nowpage")){
                $("#paging .menu").removeClass("active");
                $(event.target).addClass("active").siblings().removeClass("active");
                this.showpages = parseInt($(event.target).attr("data-page"));
                this.nowpage = 1;
                this.GetData();
            }else{
                $("#paging .menu").removeClass("active");
            }
        },
        NowPage:function(){
            this.nowpage = parseInt($(event.target).html());
            this.GetData();
        },
        ChangeFrom:function(e){
            var that = $(event.target).parent("div");
            if(that.hasClass("btn-all")){
                this.from_limit = [0,1,2];
                that.addClass("active").siblings().removeClass("active");
            }else{
                if(!that.hasClass("active")){
                    if(that.siblings(".btn-all").hasClass("active")){
                        this.from_limit = [that.attr("data-from")];
                        that.siblings(".btn-all").removeClass("active");
                    }else{
                        this.from_limit.push(that.attr("data-from"))
                    }
                    that.addClass("active");
                }else{
                    that.removeClass("active");
                    for(var i =0;i<this.from_limit.length;i++){
                        if(this.from_limit[i] == that.attr("data-from")){
                            this.from_limit.splice(i,1);
                        }
                    }
                }
            }
            this.GetData();
        },
        ChangeStatus:function(){
            var that = $(event.target).parents(".status-btn");
            if(!that.hasClass("active")){
                that.addClass("active").siblings().removeClass("active");
                this.status_limit = that.attr("data-status");
                this.GetData();
            }

        },
        PrePage:function(){
            if(this.nowpage>1){
                this.nowpage--;
                this.GetData();
            }
        },
        NextPage:function(){
            if(this.nowpage<this.Pages){
                this.nowpage++;
                this.GetData();
            }
        },
        LastPage:function(){
            if(this.nowpage<this.Pages){
                this.nowpage = this.Pages;
                this.GetData();
            }
        },
        FirstPage:function(){
            if(this.nowpage>1){
                this.nowpage = 1;
                this.GetData();
            }
        }

    },
    components:{
        "lis":{
            props:["to","index"],
            template:'<li :class="{active:to.reply.content}">'
                +'<div class="content">'
                    +'<div>'
                        +'<div>'
                            +'<div v-if="to.img" @click="ImageCheck">'
                                +'<img src="../../image/link.png" alt=""/><h3>查看截图</h3>'
                            +'</div>'
                        +'<i>{{to.description}}</i>'
                        +'</div>'
                    +'</div>'
                +'<div>'
                +'<div v-if="to.from == 0">'
                +'<p>我家小黑</p>'
                +'<p>App</p>'
                +'</div>'
                +'<div v-else-if="to.from == 1">'
                +'<p>微信应用</p>'
                +'</div>'
                +'<div v-else-if="to.from == 2">'
                +'<p>后台</p>'
                +'<p>管理中心</p>'
                +'</div>'
                +'</div>'
                +'<div>'
                +'<p v-for="data in to.module">{{data}}</p>'
                +'</div>'
                +'<div>'
                +'<div v-if="to.times == 0">'
                +'<p>只出现过一次</p>'
                +'<p>再未复现过</p>'
                +'</div>'
                +'<div v-else-if="to.times == 1">'
                +'<p>偶尔出现</p>'
                +'<p>未有发现规律</p>'
                +'</div>'
                +'<div v-else-if="to.times == 2">'
                +'<p>一定规律会触发</p>'
                +'<p>100%发生</p>'
                +'</div>'
                +'<div v-else-if="to.times == 3">'
                +'<p>必定触发</p>'
                +'</div>'
                +'</div>'
                +'<div>'
                +'<div v-if="to.level == 0">'
                +'<p>没有影响</p>'
                +'<p>但是降低工作效率</p>'
                +'</div>'
                +'<div v-else-if="to.level == 1">'
                +'<p>影响正常工作</p>'
                +'<p>并且降低工作效率</p>'
                +'</div>'
                +'<div v-else-if="to.level == 2">'
                +'<p>无法正常工作</p>'
                +'<p>必须解决此bug</p>'
                +'<p>才能进行正常工作</p>'
                +'</div>'
                +'<div v-else-if="to.level == 3">'
                +'<p>无法正常工作</p>'
                +'<p>所有工作都因此停止</p>'
                +'</div>'
                +'</div>'
                +'<div>'
                +'<p>{{to.sub_time.split(" ")[0]}} {{to.sub_time.split(" ")[1]}}</p>'
                +'</div>'
                +'<div>'
                +'<p>{{to.solve_time.split(" ")[0]}} {{to.solve_time.split(" ")[1]}}</p>'
                +'</div>'
                +'<div>'
                +'<p>{{to.user.type}}：{{to.user.name}}</p>'
                +'</div>'
                +'<div>'
                +'<div v-if="to.status == 1">'
                    +'<img  src="../../image/done-gou.png" alt=""/>'
                    +'<p>已修复</p>'
                +'</div>'
                +'<div v-else-if="to.status == 0">'
                    +'<div class="solve" title="将问题状态设为已解决" @click="SetReply">已解决</div>'
                    +'<div class="reply" @click="Remark" :data-id="to.id" v-if="!to.reply.name || !to.reply.content">回复</div>'
                +'</div>'
                +'</div>'
                +'</div>'
            +'<div class="reply" v-if="to.reply.content">'
            +'<p>管理员：{{to.reply.name}} @回复:</p>'
            +'<p>{{to.reply.content}}</p>'
            +'<div class="delete">'
            +'<img src="../../image/X.png" alt=""/>'
            +'<p @click="Delete">删除</p>'
            +'</div>'
            +'</div>'
            +'</li>',
            methods:{
                ImageCheck:function(){
                    $("#cover").addClass("active");
                    cover.imgs = this.to.img;
                    cover.now = 0;
                    cover.$nextTick(function(){
                        $("#cover .wrap .content img")[0].onload = function(){
                            cover.ImgWidth();
                        }
                    })
                },
                Remark:function(){
                    if($("#remarks-pop").position().top == $(event.target).position().top-10 ){
                        $("#remarks-pop").removeClass("active");
                        $("#remarks-text").val("");
                    }else{
                        $("#remarks-pop").addClass("active").css({"left":$(event.target).position().left-590,"top":$(event.target).position().top-10});
                        $("#remarks-pop").attr("target",$(event.target).attr("data-id"));
                        $("#remarks-pop").attr("data-index",this.index);
                        $("#placeholder>span").html(this.to.user.type+":"+this.to.user.name+":");
                        $("#remarks-text").css("text-indent",$("#placeholder").width()+10);
                    }
                    event.stopPropagation();
                },
                Delete:function(){                                //删除回复
                    var con = confirm("确认删除这条回复吗？");
                    if (con) {
                        var that = this;
                        $.ajax({                                  //==================================ajax=============删除回复
                            url: "",
                            type: "post",
                            data: {
                                id: this.to.id,                 //bug的id
                                userid:"",                      //userid
                                token:""                        //token
                            },
                            success:function () {
                                that.to.reply = {};
                            }
                        });
                    }
                },
                SetReply:function(){
                    var con = confirm("确认已解决该BUG吗？");
                    if(con){
                        var that = this;                                       //================ajax=========将bug状态设为已解决
                        $.ajax({
                            url: "",
                            type: "post",
                            data: {
                                id: this.to.id,               //bugid
                                userid:"",                     //userid
                                token:""                      //token
                            },
                            success: function () {
                                that.to.status = 1;
                            }
                        });
                    }
                }

            }
        }
    }

});
main.GetData();

//获取已提交过BUG的人员列表
$(function(){
    $.ajax({                                      //=================================ajax================获取已提交过BUG的人员列表
        url:"",
        type:"POST",
        data:{
            userid:"??",                         //userid
            token:""                             //token
        },
        dataType:"json",
        success:function(e){
            search_user.list = e.list;
        }
    })
});

var search_user= new Vue({
    el:"#search-status",
    data:{
        list:[
            {
                id:0,
                name:"张辽"
            },
            {
                id:1,
                name:"甘宁"
            },
            {
                id:2,
                name:"赵云"
            },
            {
                id:999,
                name:"全部人员"
            }
        ]
    },
    methods:{
        Select:function(){
            $(event.target).parent(".menu").siblings("p").html($(event.target).html());
            $(event.target).parents("#search-status").attr("data-id",$(event.target).attr("data-id"));
            $(event.target).addClass("active").siblings().removeClass("active");
        }
    }
});
$("#search-status").on("click",function(){
    if($(this).children(".menu").hasClass("active")){
        $(this).children(".menu").removeClass("active");
    }else{
        $(this).children(".menu").addClass("active");
    }
});
//回复
$("#remarks-pop #remarks-submit").on("click",function(){
    if($("#remarks-text").val() !=""){
        $.ajax({                                 //======================ajax==================================提交回复
            url:"",
            type:"POST",
            data:{
                id:$("#remarks-pop").attr("target"),        //bugid
                text:$("#remarks-text").val()               //回复内容
            },
            success:function(){
                Vue.set(main.lis[$("#remarks-pop").attr("data-index")].reply,"content",$("#remarks-text").val());
                Vue.set(main.lis[$("#remarks-pop").attr("data-index")].reply,"name","欢哥");        //====================回复管理员的名字
                $("#remarks-pop").removeClass("active");
                $("#remarks-text").val("");
            }
        })
    }else{
        alert("请先输入内容!")
    }

});

//回复栏弹出
$("#remarks-pop").on("click",function(){
    event.stopPropagation();
});
$("#remarks-pop #remarks-cancel").on("click",function(){
    $("#remarks-pop").removeClass("active");
    $("#remarks-text").val("");
});


$(window).on("click",function(){
    if($("#remarks-pop").hasClass("active")){
        $("#remarks-pop").removeClass("active");
    }
    if($("#select-date").hasClass("active")){
        $("#select-date").slideUp(0).removeClass("active");
        $("[time=active]").attr("time","");
    }
});



var cover = new Vue({
    el:"#cover",
    data:{
        imgs:[],
        now:0
    },
    methods:{
        Next:function(){
            if($(event.target).hasClass("active")){
                var _this = this;
                this.now = this.now+1;
                this.$nextTick(function(){
                    $("#cover .wrap .content img")[0].onload = function(){
                        _this.ImgWidth();
                    }
                })
            }
        },
        Pre:function(){
            if($(event.target).hasClass("active")){
                var _this = this;
                this.now = this.now-1;
                this.$nextTick(function(){
                    $("#cover .wrap .content img")[0].onload = function(){
                        _this.ImgWidth();
                    }
                })
            }
        },
        Close:function(){
            this.$el.setAttribute("class","");
        },
        ImgWidth:function(){
            var imgwidth = $("#cover .wrap .content img").width();
            console.log(imgwidth)
            if(imgwidth>1020){
                $("#cover .wrap").width(imgwidth+60);
            }else{
                $("#cover .wrap").width(1020);
            }
        }
    }
});

//时间选择绑定
$("#search-starttime").on("click",function(){
    var data={
        that:$("#search-starttime"),
        position:"bottom",
        y:$(this).attr("y"),
        m:$(this).attr("m"),
        d:$(this).attr("d"),
        h:$(this).attr("h"),
        n:$(this).attr("n"),
        s:$(this).attr("s"),
        type:"second"
    };
    TimeShow(data);
});
$("#search-endtime").on("click",function(){
    var data={
        that:$("#search-endtime"),
        position:"bottom",
        y:$(this).attr("y"),
        m:$(this).attr("m"),
        d:$(this).attr("d"),
        h:$(this).attr("h"),
        n:$(this).attr("n"),
        s:$(this).attr("s"),
        type:"second"
    };
    TimeShow(data);
});

//搜索
$("#search-btn").on("click",function(){
    var keyword = $("#search-content").val();
    var starttime = $("#search-starttime").html();
    var endtime = $("#search-endtime").html();
    var keyuserid = $("#search-status").attr("data-id");
    if(endtime >starttime){
        $.ajax({                                            //==============================ajax===========搜索
            url:"",
            type:"POST",
            data:{
                userid:"?",            //userid
                token:"",              //token

            },
            success:function(e){
                main.alldata = e.list;
                main.getData();
            }
        })
    }else{
        alert("结束时间必须大于开始时间！")
    }

});

function toRed(content){
    if(content){
        var data = $("#order-content-main>li>div.content>div:first-child>div>i");
        for(var i =0;i<data.length;i++){
            var text  =data.eq(i).html();
            var ntext =text.replace(new RegExp(content,"gm"),"<font color='red'>"+content+"</font>");
            data.eq(i).html(ntext);
        }
    }
}
